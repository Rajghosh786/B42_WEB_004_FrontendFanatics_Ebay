<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shopping Cart</title>
    <link rel="stylesheet" href="../css/shoppingcart.css">
    <script src="https://kit.fontawesome.com/d792cef6f0.js" crossorigin="anonymous"></script>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
</head>
<body>
    <!--  Main navbar  -->
<nav class="navbar-t">
    <div class="left">
        <!-- Auth Links will be dynamically updated here -->
        <p id="auth-links">Hi! <a href="login.html">Sign in</a> or <a href="signup.html">register</a></p>
        <p><a href="ebayDailyDeals.html">Daily Deals</a></p>
        <p><a href="brandoutlet.html">Brand Outlet</a></p>
        <p><a href="giftcard.html">Gift Cards</a></p>
        <p><a href="help&contact.html">Help & Support</a></p>
    </div>
    <ul class="menu">
        <li><a href="sell.html">Sell</a></li>
        <li><a href="wishlist.html">Wishlist</a> <i class="fa-solid fa-angle-down"></i></li>
        <li><a href="wishlist.html">My eBay</a> <i class="fa-solid fa-angle-down"></i></li>
        <a href="#"><i class="fa-regular fa-bell"></i></a>
        <a href="shoppingcart.html"><i class="fa-solid fa-cart-shopping"></i></a>
    </ul>
  </nav>
  
      <nav class="navbar-b">
        <a href="../index.html"><img src="https://upload.wikimedia.org/wikipedia/commons/1/1b/EBay_logo.svg" alt="eBay Logo" class="logo"></a>
          <div class="category-dropdown">
              <p class="category-btn">Shop by Category <i class="fa-solid fa-angle-down"></i> </p>
              <div class="dropdown-content">
                  <div class="column">
                      <h4>Motors</h4>
                      <p>Parts & Accessories</p>
                      <p>Cars & Trucks</p>
                      <p>Motorcycles</p>
                      <p>Other Vehicles</p>
                  </div>
                  <div class="column">
                      <h4>Electronics</h4>
                      <p>Computers, Tablets & Network Hardware</p>
                      <p>Cell Phones, Smart Watches & Accessories</p>
                      <p>Video Games & Consoles</p>
                      <p>Cameras & Photo</p>
                  </div>
                  <div class="column">
                      <h4>Collectibles & Art</h4>
                      <p>Trading Cards</p>
                      <p>Collectibles</p>
                      <p>Coins & Paper Money</p>
                      <p>Sports Memorabilia</p>
                  </div>
                  <div class="column">
                      <h4>Home & Garden</h4>
                      <p>Yard, Garden & Outdoor Living Items</p>
                      <p>Tools & Workshop Equipment</p>
                      <p>Home Improvement</p>
                      <p>Kitchen, Dining & Bar Supplies</p>
                  </div>
              </div>
          </div>
          <div class="search-container">
              <i class="fa-solid fa-magnifying-glass"></i><input type="text" placeholder="Search for anything" class="search-input">
              <select class="category-dropdown">
                  <option>All Categories</option>
                  <option>Electronics</option>
                  <option>Fashion</option>
                  <option>Home & Garden</option>
                  <option>Jewellery</option>
                  <option>Men's Wear</option>
                  <option>Women's Wear</option>
              </select>
              
          </div>
          <button class="search-button">Search</button>
          <a href="ebayAdvance.html" class="advanced-search">Advanced</a>
      </nav> <hr>
  
  <!--   main nav bar end -->
    <div class="head">
        <h1>Shopping Cart</h1>
        <ul>
            <a href="./feedback.html"><p>Send Us your comments</p> </a>
        </ul>
    </div>
    <div class="notification-bar">
        You're signed out right now. To save these items or see your previously saved items, <a href="#">sign in</a>.
    </div>

    <div class="container">
        <div class="main-content">
            <div class="seller-info">
                <div class="seller-avatar"></div>
                <div>
                    <a style="color: black;" href="#">meilan_x1</a>
                    <div>100% positive feedback</div>
                </div>
            </div>
            <div class="product-card">
                
                <img src="https://i.ebayimg.com/images/g/HpkAAOSwWRZnoOVT/s-l225.webp" alt="Omega Speedmaster" class="product-image">
                <div class="product-details">
                    <a href="#"><h3>New Omega Speedmaster Dark Side of the Moon Men's Watch 310.92.44.50.01.001</h3></a>
                    <div>New with tags</div>
                    <p>Qty</p>
                    <select class="quantity-selector">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                </div>
                <div class="price">
                    <p>US $398.68</p>
                    <h5 style="color: green;">Free Shipping</h5>
                    <p style="font-size: 18px; font-weight: 100;">Returns Accepted</p>
                    <div class="save">
                        <a href="#">save for letter</a>
                        <a href="#">Remove</a>
                    </div>
                </div>
            </div>
            <div class="related-items">
                <h2>Explore related items</h2>
                <p style="font-size: large;">Sponsored</p>
                <div class="related-grid">
                    <div class="related-item">
                        <img src="https://i.ebayimg.com/thumbs/images/g/O~YAAOSw-NRnLXHQ/s-l500.jpg" alt="Tag Heuer Watch">
                        <a href="#"><p>Tag Heuer Aquaracer 43 Men's Watch quartz Chronograph....</p></a>
                        <a href="#"><p>New</p></a>
                        <div class="price">$855.00</div>
                        <a href="#"><h3>Free Shipping</h3></a>
                        <a href="#"><p>Seller with 100% positive feedback</p></a>
                    </div>
                    <div class="related-item">
                        <img src="https://i.ebayimg.com/images/g/SqMAAOSwhD5ni25a/s-l1600.webp" alt="Omega Watch Box">
                        <a href="#"><p>Omega Speedmaster Mission To The Moon Phase S033B700 Ceramic Black...</p></a>
                        <a href="#"><p>Pre Owned</p></a>
                        <div class="price">$727.17</div>
                        <a href="#"><p>+ US $22.00 shipping seller with 100% positive feedback</p></a>
                    </div>
                    <div class="related-item">
                        <img src="https://i.ebayimg.com/thumbs/images/g/rgIAAOSwRHlnmLej/s-l500.jpg" alt="Omega Watch">
                        <a href="#"><p>Premium Rubber Watch Strap Band Bracelet Made for Omega Speedmaster...</p></a>
                        <a href="#"><p>New</p></a>
                        <div class="price">$742.68</div>
                        <a href="#"><h3>Free Shipping</h3></a>
                        <a href="#"><p>Seller With 100% positive feedback</p></a>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="sidebar">
            <div class="item-count">Item (0)</div>
            <div>Shipping to 132140</div>
            <div style="margin: 20px 0;">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <div>Subtotal</div>
                    <div class="price subtotal">₹0.00</div>
                </div>
                <div style="color: green;">Free shipping</div>
            </div>
            <a href="checkout.html"><button class="checkout-button">Go to checkout</button></a>
            <div style="margin-top: 10px; text-align: center;">
                <small>Purchase protected by eBay Money Back Guarantee</small>
            </div>
        </div>
        
    <footer class="same-footer">
        <p>
          Copyright © 1995-2025 eBay Inc. All Rights Reserved.
          <a href="#" class="same-link">Accessibility</a>,
          <a href="#" class="same-link">User Agreement</a>,
          <a href="#" class="same-link">Privacy</a>,
          <a href="#" class="same-link">Payments Terms of Use</a>,
          <a href="#" class="same-link">Cookies</a>,
          <a href="#" class="same-link">CA Privacy Notice</a>,
          <a href="#" class="same-link">Your Privacy Choices</a>, and
          <a href="#" class="same-link">AdChoice</a>.
        </p>
      </footer>

</body>
</html>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
    import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js";
    import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-database.js";
  
    const firebaseConfig = {
        apiKey: "AIzaSyA-8DveOlIlHvyK813rJbm4q-xTpdtb9n0",
        authDomain: "users-database-e953e.firebaseapp.com",
        databaseURL: "https://users-database-e953e-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "users-database-e953e",
        storageBucket: "users-database-e953e.firebasestorage.app",
        messagingSenderId: "622398829390",
        appId: "1:622398829390:web:930571c5fb5aa985a3641f",
    };
  
    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const authLinksDiv = document.getElementById("auth-links");
  
    const checkLoginState = () => {
        const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true'; // Check if user is logged in
        if (isLoggedIn) {
            const userName = localStorage.getItem('userName');
            authLinksDiv.innerHTML = `
                Hi, ${userName}
                <a href="#" class="logout">Logout</a>
            `;
        } else {
            authLinksDiv.innerHTML = `
                Hi! <a href="login.html">Sign in</a> or 
                <a href="signup.html">register</a>
            `;
        }
    };
  
    window.onload = checkLoginState;
  
    auth.onAuthStateChanged((user) => {
        if (user) {
            const userRef = ref(getDatabase(), "users/" + user.uid);
            get(userRef).then((snapshot) => {
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    const userFirstName = userData.personal_Firstname; 
                    localStorage.setItem('isLoggedIn', 'true');
                    localStorage.setItem('userName', userFirstName);
                }
            });
        } else {
            localStorage.setItem('isLoggedIn', 'false');
            localStorage.removeItem('userName');
        }
        checkLoginState();
    });
  
    const logoutUser = () => {
        signOut(auth)
            .then(() => {
                localStorage.setItem('isLoggedIn', 'false');
                localStorage.removeItem('userName');
                window.location.href = "login.html"; // Redirect to login
            })
            .catch((error) => {
                console.error("Error logging out:", error);
            });
    };
  
    document.body.addEventListener("click", (event) => {
        if (event.target && event.target.classList.contains("logout")) {
            logoutUser();
        }
    });

    const searchInput = document.querySelector(".search-input");
  const searchbutton = document.querySelector(".search-button");
  let productName;
  searchInput.addEventListener("input", (e) => {
    productName = e.target.value;
  });
  searchbutton.addEventListener("click", (e) => {
    console.log(productName);

    fetch(
      "https://products-database-7e889-default-rtdb.asia-southeast1.firebasedatabase.app/.json"
    )
      .then((res) => res.json())
      .then((data) => {
        let filteringData = Object.values(data).filter((item) => {
          return (
            item.name &&
            item.name.toLowerCase().includes(productName.toLowerCase())
          );
        });

        // console.log(filteringData);
        // if (filteringData.length > 0) {
        localStorage.setItem('filteredProducts', JSON.stringify(filteringData));
        window.location.href = "laptop.html";
    // }
      })
      .catch((err) => {
        console.error("Error fetching data:", err);
      });
    searchInput.value = "";
  });




  const cartContainer = document.querySelector(".product-card");

const loadCart = () => {
    let cart = JSON.parse(localStorage.getItem('cart')) || [];
    console.log('Loaded Cart:', cart);


    const style = document.createElement("style");
    style.innerHTML = `
        .product-card {
            display: block; /* Ensures each product card is displayed below the other */
            margin-bottom: 20px; /* Adds space between product cards */
        }
    `;
    document.head.appendChild(style);


    if (cart.length > 0) {
        cartContainer.innerHTML = ''
        cartContainer.innerHTML = cart.map(product => `
            <div class="product-card">
                <img src="${product.imageURL}" alt="${product.name}" class="product-image">
                <div class="product-details">
                    <a href="#"><h3>${product.name}</h3></a>
                    <div>New with tags</div>
                    <p>Qty</p>
                    <select class="quantity-selector">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                    </select>
                </div>
                <div class="price">
                    <p>₹${product.salePrice}</p>
                    <h5 style="color: green;">Free Shipping</h5>
                    <p style="font-size: 18px; font-weight: 100;">Returns Accepted</p>
                    <div class="save">
                        <a href="#">Save for later</a>
                        <a href="#" onclick="removeFromCart('${product.productID}')">Remove</a>
                    </div>
                </div>
            </div>
        `).join('');
        

        updateSidebar(cart);
    } else {
        cartContainer.innerHTML = `<p>Your cart is empty.</p>`;
        updateSidebar([]);
    }
};

const updateSidebar = (cart) => {
    const itemCount = cart.length;
    const subtotal = cart.reduce((total, product) => total + parseFloat(product.salePrice), 0);


    const itemCountElement = document.querySelector(".sidebar .item-count");
    const subtotalElement = document.querySelector(".sidebar .subtotal");

    if (itemCountElement) {
        itemCountElement.textContent = `Item (${itemCount})`;
    }
    if (subtotalElement) {
        subtotalElement.textContent = `₹${subtotal.toFixed(2)}`;
    }
};

window.onload = loadCart;

  </script>